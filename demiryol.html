<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>API Test</title>
</head>
<body>
  <h2>API Tekshiruvi</h2>
  <input type="text" id="code" placeholder="Bron kodini kiriting (masalan: QUAPWZ)" maxlength="6" />
  <button onclick="testApi()">ğŸ” Soâ€˜rov yuborish</button>
  <p id="status" style="margin-top:10px; font-family:monospace;"></p>

  <script>
    async function testApi() {
      const code = document.getElementById('code').value.trim().toUpperCase();
      const statusEl = document.getElementById('status');
      
      if (!code || code.length !== 6 || !/^[A-Z0-9]{6}$/.test(code)) {
        statusEl.innerHTML = 'âš ï¸ Kod 6 ta katta harf/raqam boâ€˜lishi kerak';
        return;
      }

      statusEl.innerHTML = 'â³ Soâ€˜rov yuborilmoqda...';

      try {
        console.log('Soâ€˜rov yuborilayotgan manzil:', `https://yenil.ru/api/demiryol?id=${code}`);
        const res = await fetch(`https://yenil.ru/api/demiryol?id=${code}`);

        console.log('Javob statusi:', res.status);
        console.log('Javob headers:', Object.fromEntries([...res.headers.entries()]));

        if (!res.ok) {
          const text = await res.text();
          console.error('Xato javobi:', text);
          statusEl.innerHTML = `âŒ Xato: ${res.status} â€” ${text}`;
          return;
        }

        const data = await res.json();
        console.log('Muvaffaqiyatli javob:', data);
        statusEl.innerHTML = 'âœ… Javob konsolga chiqarildi (DevTools â†’ Console)';
      } catch (err) {
        console.error('Fetch xatosi:', err);
        statusEl.innerHTML = `ğŸ’¥ Fetch xatosi: ${err.message}`;
      }
    }
  </script>
</body>
</html>
